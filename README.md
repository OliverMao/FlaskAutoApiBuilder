

<div align="center"><a href="https://github.com/OliverMao/FlaskAutoApiBuilder" ><img width="300" src="https://z1.ax1x.com/2023/11/14/piYkvUU.png" alt="piYkvUU.png" border="0" /></a>
<h1> ğŸ“¦ Faab - Flask Auto API Builder</h1><div><a href="https://github.com/OliverMao/FlaskAutoApiBuilder" ><img  src="https://img.shields.io/badge/license-GPL3.0-blue.svg" alt="license" border="0" /></a>
  <img  src="https://img.shields.io/github/stars/OliverMao/FlaskAutoApiBuilder.svg" alt="stars" border="0" />
  <img  src="https://img.shields.io/github/forks/OliverMao/FlaskAutoApiBuilder.svg" alt="forks" border="0" />
  <img  src="https://img.shields.io/badge/version-0.1.6-686480r.svg" alt="forks" border="0" />
</div></div>







## é¡¹ç›®ç®€ä»‹

"Flask Auto API Builder" æ˜¯ä¸€ä¸ªåŸºäº Flask æ¡†æ¶çš„è‡ªåŠ¨ API æ„å»ºå·¥å…·ã€‚

æœ¬å·¥å…·å¯ä»¥æ ¹æ®ç»™å®šçš„æ•°æ®æ¨¡å‹æˆ–æ•°æ®åº“æ¨¡å¼è‡ªåŠ¨ç”Ÿæˆ API ç«¯ç‚¹ï¼ŒåŒ…æ‹¬åˆ›å»ºã€è¯»å–ã€æ›´æ–°å’Œåˆ é™¤ï¼ˆCRUDï¼‰æ“ä½œã€‚å®ƒä»¬å¯ä»¥å‡å°‘å¼€å‘äººå‘˜æ‰‹åŠ¨ç¼–å†™å’Œé…ç½® API ç«¯ç‚¹çš„å·¥ä½œé‡ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚åŒæ—¶å¯ä»¥ç”ŸæˆSwaggeræ–‡æ¡£ï¼Œä¾¿äºAPIè°ƒè¯•ã€‚æ­¤å¤–ï¼ŒFaabè¿˜æä¾›äº†å¸¸è§çš„Webå·¥å…·ï¼Œå¦‚ç”¨æˆ·é‰´æƒã€ä¸Šä¼ ä¸‹è½½ç­‰åŠŸèƒ½ï¼Œè¿›ä¸€æ­¥å¢å¼ºäº†å¼€å‘è€…çš„ä½“éªŒã€‚

## åŠŸèƒ½ç‰¹æ€§

- ç”¨æˆ·èº«ä»½éªŒè¯ï¼šé€šè¿‡ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œç”¨æˆ·èº«ä»½éªŒè¯ï¼Œç¡®ä¿åªæœ‰æˆæƒç”¨æˆ·å¯ä»¥è®¿é—®å—ä¿æŠ¤çš„åŠŸèƒ½ã€‚
- åˆ›å»ºèµ„æºï¼šå…è®¸ç”¨æˆ·åˆ›å»ºæ–°çš„èµ„æºï¼Œä¾‹å¦‚åˆ›å»ºæ–°çš„æ–‡ç« ã€ä»»åŠ¡æˆ–äº‹ä»¶ç­‰ã€‚
- è¯»å–èµ„æºï¼šæä¾›å¯¹å·²å­˜åœ¨èµ„æºçš„è¯»å–è®¿é—®æƒé™ï¼Œä¾‹å¦‚è·å–æ–‡ç« çš„è¯¦ç»†ä¿¡æ¯æˆ–æŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨ã€‚
- æ›´æ–°èµ„æºï¼šå…è®¸ç”¨æˆ·å¯¹ç°æœ‰èµ„æºè¿›è¡Œæ›´æ–°ï¼Œä¾‹å¦‚ç¼–è¾‘æ–‡ç« å†…å®¹æˆ–ä¿®æ”¹ä»»åŠ¡çŠ¶æ€ã€‚
- åˆ é™¤èµ„æºï¼šå…è®¸ç”¨æˆ·åˆ é™¤ä¸å†éœ€è¦çš„èµ„æºï¼Œä¾‹å¦‚åˆ é™¤æ–‡ç« ã€ä»»åŠ¡æˆ–äº‹ä»¶ç­‰ã€‚
- æœç´¢åŠŸèƒ½ï¼šæä¾›åŸºäºå…³é”®å­—çš„æœç´¢åŠŸèƒ½ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿå¿«é€Ÿæ‰¾åˆ°æ‰€éœ€çš„èµ„æºã€‚
- åˆ†é¡µå’Œæ’åºï¼šæ”¯æŒå¯¹èµ„æºåˆ—è¡¨è¿›è¡Œåˆ†é¡µå’Œæ’åºï¼Œä»¥ä¾¿ç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°æµè§ˆå’Œç®¡ç†å¤§é‡æ•°æ®ã€‚
- æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼šå…è®¸ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨ï¼Œå¹¶æä¾›ä¸‹è½½å·²ä¸Šä¼ çš„æ–‡ä»¶çš„åŠŸèƒ½ã€‚
- æ•°æ®éªŒè¯ï¼šå¯¹ç”¨æˆ·è¾“å…¥çš„æ•°æ®è¿›è¡ŒéªŒè¯ï¼Œç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§ã€‚
- é”™è¯¯å¤„ç†ï¼šæä¾›å‹å¥½çš„é”™è¯¯æç¤ºå’Œå¤„ç†æœºåˆ¶ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿè½»æ¾è¯†åˆ«å’Œè§£å†³é—®é¢˜ã€‚
- è®¿é—®æ§åˆ¶ï¼šåŸºäºç”¨æˆ·è§’è‰²å’Œæƒé™ï¼Œé™åˆ¶ç”¨æˆ·å¯¹æ•æ„Ÿèµ„æºå’ŒåŠŸèƒ½çš„è®¿é—®æƒé™ã€‚
- æ—¥å¿—è®°å½•ï¼šè®°å½•å…³é”®æ“ä½œå’Œäº‹ä»¶ï¼Œä»¥ä¾¿è¿›è¡Œæ•…éšœæ’æŸ¥å’Œå®¡è®¡ã€‚
- API æ–‡æ¡£ç”Ÿæˆï¼šè‡ªåŠ¨ç”Ÿæˆ API æ–‡æ¡£ï¼Œä½¿å¼€å‘äººå‘˜å’Œç”¨æˆ·èƒ½å¤Ÿäº†è§£å¯ç”¨çš„ API ç«¯ç‚¹å’Œå‚æ•°ã€‚

## æŠ€æœ¯æ ˆä¸ä¾èµ–é¡¹

- Flask
- SQLAlchemy
- flasgger
- PyJWT
- Flask-CORS
- Redis
- PyMySQL
- RPC
- Flask-JSONRPC
- FFmpeg

## å¿«é€Ÿå¼€å§‹

0. åˆ›å»ºapp.py
1. åˆ›å»ºfactory.pyã€blueprintsï¼ˆæ ¹æ®å¼€å‘é¡¹ç›®è‡ªå®šï¼‰
	
	> å¯ç›´æ¥ä½¿ç”¨Faabæä¾›çš„demoè¿›è¡Œå¼€å‘
	
2. å®‰è£…Faabï¼š
    ```
    pip install Faab
    ```
3. é¡¹ç›®ä¸­å¼•å…¥
    ```python
    from Faab import Faab
    
    from Faab.FaabJWT import jwt_authentication
    from blueprints.test import test_bp
    from blueprints.test.model import Users, TabNavMenu
    import factory as fac 
    ```
4. é…ç½®æ•°æ®åº“è¿æ¥
	> ä¸€å®šè¦æ–°å»ºä¸€ä¸ªåä¸ºfaabçš„æ•°æ®åº“
   
    ```python
    class DBConfig(object):
        # DBåŠFlaskåŸºç¡€é…ç½®
        user = 'faab'
        host = 'localhost'
        password = 'faab'
        SQLALCHEMY_DATABASE_URI = 'mysql+pymysql://%s:%s@%s:3306/%s' % (user, password, host, 'faab')
        SQLALCHEMY_BINDS = {
            'test': 'mysql+pymysql://%s:%s@%s:3306/%s' % (user, password, host, 'test')
        }
        SECRET_KEY = 'session_key'
    ```
5. é…ç½®AutoAPI Modelä¸è“å›¾
	```python
	class Spu(db.Model):
    __bind_key__ = 'test'
    __tablename__ = 'spu'
    __table_args__ = {'extend_existing': True}
    id = db.Column(db.Integer, primary_key=True, autoincrement=True)
    name = db.Column(db.String(255), default='')
    desc = db.Column(db.String(255), default='')
    price = db.Column(db.Integer, default=0)
    add_time = db.Column(db.DateTime, default=db.func.now())
    is_delete = db.Column(db.Integer, default=0)
	
    class Users(FieldPermissionMixin, db.Model):
        __bind_key__ = 'test'
        __tablename__ = 'users'
        __table_args__ = {'extend_existing': True}
        id = db.Column(db.Integer, primary_key=True, autoincrement=True)
        faab_uid = db.Column(db.String(255), unique=True)
        username = db.Column(db.String(255), unique=True)
        password = db.Column(db.String(255))
        nickname = db.Column(db.String(255), default='')
        is_delete = db.Column(db.Integer, default=0)
	
        def accessible(self, user):
           # æ ¹æ®userçš„è§’è‰²æˆ–æƒé™è¿”å›ä¸åŒçš„å­—æ®µåˆ—è¡¨
           if user.get_role() == 'admin':
               fields = ['faab_uid', 'nickname', 'username', 'password', 'id']  # ç®¡ç†å‘˜å¯ä»¥è®¿é—®çš„å­—æ®µ
               allow_other_row = True  # å…è®¸è®¿é—®éæ­¤faab_uidçš„è¡Œ
           else:
	            fields = ['faab_uid', 'nickname']  # å…¶ä»–ç”¨æˆ·åªèƒ½è®¿é—®éƒ¨åˆ†å­—æ®µ
	            allow_other_row = False  # ä¸å…è®¸è®¿é—®éæ­¤faab_uidçš„è¡Œ
	        return {'fields': fields, 'allow_other_row': allow_other_row}
   
   ```
   æ ¹æ®æ˜¯å¦éœ€è¦å­—æ®µçº§æƒé™æ§åˆ¶ï¼Œè¿›è¡Œæ•°æ®è¡¨modelæ˜¯å¦ç»§æ‰¿FieldPermissionMixinç±»ã€‚å¦‚ç»§æ‰¿ç±»ï¼Œåˆ™_Need_keysæŸ¥è¯¢å¯¹æƒé™å­—æ®µè¿›è¡Œäº¤é›†å¤„ç†åè¿”å›ã€‚
   
    ```python
    models = [
        [
            {
                "model": your_model,
                "bp": your_blueprints,
                "url_prefix": "your_url_prefix"
            }
        ]
    ]
    
    app = Faab(__name__)
    app.add_models(models)
    app.add_db_config(DBConfig)
    fac.register(app) #å¯é€‰
    ```
6. é…ç½®å¯åŠ¨å‚æ•°
    ```python
    if __name__ == '__main__':
        app.run(debug=True, port=5000, host='0.0.0.0')
    ```
7. è¿è¡Œ
    ```shell
    python app.py
    ```
8. åœ¨æµè§ˆå™¨ä¸­è®¿é—®Swaggeræ–‡æ¡£ï¼š
   ```
   http://localhost:5000/apidocs
   ```


## Faabå¼€å‘æ–‡æ¡£

è¯¦ç»†çš„æ–‡æ¡£å°†åœ¨æ­£å¼ç‰ˆæ›´æ–°ã€‚

## RPC

å¯¹äºç”¨æˆ·æƒé™æ§åˆ¶ï¼Œé‡‡ç”¨äº†æ€»è¡¨çš„æ–¹å¼ï¼Œä½äºfaabæ•°æ®åº“çš„faab_usersè¡¨å†…è¿›è¡Œäº†èº«ä»½æƒé™çš„æ§åˆ¶ç®¡ç†ã€‚faab_usersè¡¨é‡‡ç”¨äº†Snowflakeï¼Œæ–¹ä¾¿åˆ†å¸ƒå¼ç³»ç»Ÿå¯¹ç”¨æˆ·çš„UIDè¿›è¡Œç®¡ç†ã€‚å¦‚ä½¿ç”¨å­—æ®µæƒé™ç®¡ç†ï¼Œåœ¨ç”¨æˆ·æ³¨å†Œæ—¶è¯·è°ƒç”¨RPCæ¥å£å¦‚
```python
url = 'http://127.0.0.1:8011/rpc'
payload = {
"jsonrpc": "2.0",
"method": "FaabRegister",
"params": {"username": username, "password": password, "role": "user"},
"id": 1
}
```
resultè¿”å›å€¼code:200ä¸ºæ­£ç¡®åŠ å…¥ï¼Œå…¶ä½™æƒ…å†µè¯·å‹¿æ·»åŠ æ–°ç”¨æˆ·ã€‚å¯¹äºç”¨æˆ·æƒé™åç§°ï¼Œä¾‹å¦‚adminã€userï¼Œå‡ç”±å¼€å‘è€…è¿›è¡Œæ§åˆ¶ï¼Œè®¿é—®æƒé™äºmodelä¸­è¿›è¡Œç®¡ç†ã€‚

## å¼€æºä¸æ˜“, æœ‰äº†æ‚¨çš„èµåŠ©, æˆ‘ä»¬ä¼šåšçš„æ›´å¥½~

  <img src="./static/donate.jpg" alt style="width: 20%;">


## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ GNU é€šç”¨å…¬å…±è®¸å¯è¯ï¼ˆGNU General Public Licenseï¼Œç®€ç§° GPLï¼‰è¿›è¡Œè®¸å¯ã€‚è¿™æ„å‘³ç€æ‚¨æœ‰æƒä½¿ç”¨ã€å¤åˆ¶ã€ä¿®æ”¹å’Œåˆ†å‘æœ¬é¡¹ç›®çš„æºä»£ç å’Œè¡ç”Ÿä½œå“ï¼Œä½†éœ€è¦éµå®ˆä»¥ä¸‹æ¡ä»¶ï¼š

1. ç‰ˆæƒå£°æ˜ï¼šæ‚¨éœ€è¦åœ¨æ‚¨çš„è¡ç”Ÿä½œå“ä¸­åŒ…å«åŸå§‹é¡¹ç›®çš„ç‰ˆæƒå£°æ˜å’Œè®¸å¯è¯ä¿¡æ¯ã€‚

2. å¼€æ”¾æºä»£ç ï¼šå¦‚æœæ‚¨å¯¹æœ¬é¡¹ç›®è¿›è¡Œä¿®æ”¹æˆ–æ‰©å±•ï¼Œå¹¶å°†å…¶ä½œä¸ºè¡ç”Ÿä½œå“åˆ†å‘ï¼Œæ‚¨éœ€è¦ä»¥ç›¸åŒçš„è®¸å¯è¯ï¼ˆGPLï¼‰åˆ†å‘æ‚¨çš„ä¿®æ”¹å’Œæºä»£ç ã€‚

3. æ— ä¿è¯ï¼šè¯¥é¡¹ç›®æ²¡æœ‰ä»»ä½•æ˜ç¤ºæˆ–æš—ç¤ºçš„ä¿è¯ã€‚ä½œè€…ä¸å¯¹é¡¹ç›®çš„é€‚ç”¨æ€§ã€å¯é æ€§æˆ–å‡†ç¡®æ€§æä¾›ä»»ä½•ä¿è¯ï¼Œäº¦ä¸æ‰¿æ‹…ä»»ä½•è´£ä»»ã€‚æ‚¨è‡ªæ‹…é£é™©ä½¿ç”¨æœ¬é¡¹ç›®ã€‚

4. è´¡çŒ®ï¼šå¦‚æœæ‚¨å¯¹æœ¬é¡¹ç›®è¿›è¡Œè´¡çŒ®ï¼Œæ‚¨åŒæ„å°†æ‚¨çš„è´¡çŒ®æˆäºˆåŸå§‹é¡¹ç›®çš„æ‰€æœ‰è€…ï¼Œå¹¶åŒæ„æ‚¨çš„è´¡çŒ®å°†åœ¨åŸå§‹é¡¹ç›®çš„ GPL è®¸å¯ä¸‹åˆ†å‘ã€‚

æœ‰å…³å®Œæ•´çš„è®¸å¯è¯æ–‡æœ¬ï¼Œè¯·å‚é˜…é¡¹ç›®æ ¹ç›®å½•ä¸­çš„ LICENSE æ–‡ä»¶ã€‚

## æŠ€æœ¯åé¦ˆä¸äº¤æµç¾¤

  <img src="./static/official.jpg" alt style="width: 20%;">

- åŠ å…¥äº¤æµç¾¤äº¤æµ
- è·å–Faabå¼€å‘æ•™ç¨‹æ–‡ç« 
- ä¸ä½œè€…è¿›è¡Œç›¸å…³äº¤æµ



